on:
  pull_request:
    branches: [drop_py2, fix_gha_autofmt]  # TODO: add `master`

jobs:
    formatter:
        name: auto-formatter
        runs-on: windows-latest
        if: github.repository == github.event.pull_request.head.repo.full_name
        steps:
          - name: Checkout
            uses: actions/checkout@v3
          - name: Set up Python
            uses: actions/setup-python@v4
            with:
              python-version: 3.7
          - name: Install black
            run: pip install black==22.12.0
          - name: Format
            run: python -m black comtypes/.
          - name: Auto-commit
            uses: stefanzweifel/git-auto-commit-action@v4
            with:
              branch: ${{ github.head_ref }}
              commit_message: apply automatic formatter
              commit_user_name: github-actions[bot]
              commit_user_email: 41898282+github-actions[bot]@users.noreply.github.com
              commit_author: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>
